<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>[译] RxJS: 白话 Subjects | Rxjs</title>
    <meta name="generator" content="VuePress 1.5.4">
    
    <meta name="description" content="目录">
    <link rel="preload" href="/assets/css/0.styles.ccac5a78.css" as="style"><link rel="preload" href="/assets/js/app.de24a261.js" as="script"><link rel="preload" href="/assets/js/2.f6e3d3ee.js" as="script"><link rel="preload" href="/assets/js/13.e45c7342.js" as="script"><link rel="prefetch" href="/assets/js/10.157238cf.js"><link rel="prefetch" href="/assets/js/11.41a012c6.js"><link rel="prefetch" href="/assets/js/12.b8086885.js"><link rel="prefetch" href="/assets/js/14.e3e54685.js"><link rel="prefetch" href="/assets/js/15.9351c89b.js"><link rel="prefetch" href="/assets/js/16.7d3aff72.js"><link rel="prefetch" href="/assets/js/17.cd3a7c14.js"><link rel="prefetch" href="/assets/js/18.7b5bc8d2.js"><link rel="prefetch" href="/assets/js/19.77700336.js"><link rel="prefetch" href="/assets/js/20.ca0fdbb6.js"><link rel="prefetch" href="/assets/js/21.d6bc78c5.js"><link rel="prefetch" href="/assets/js/22.2428074e.js"><link rel="prefetch" href="/assets/js/23.93a777ed.js"><link rel="prefetch" href="/assets/js/24.73aa7224.js"><link rel="prefetch" href="/assets/js/25.e43f6412.js"><link rel="prefetch" href="/assets/js/26.60ae3da3.js"><link rel="prefetch" href="/assets/js/27.03e00c07.js"><link rel="prefetch" href="/assets/js/28.95c8c079.js"><link rel="prefetch" href="/assets/js/29.eb8ac4a8.js"><link rel="prefetch" href="/assets/js/3.d907f710.js"><link rel="prefetch" href="/assets/js/30.5c09e00d.js"><link rel="prefetch" href="/assets/js/31.962a908d.js"><link rel="prefetch" href="/assets/js/32.c0fe7bdd.js"><link rel="prefetch" href="/assets/js/33.74f04d2b.js"><link rel="prefetch" href="/assets/js/34.20bdc3d5.js"><link rel="prefetch" href="/assets/js/35.d30ab2c2.js"><link rel="prefetch" href="/assets/js/36.d13995e1.js"><link rel="prefetch" href="/assets/js/37.08e1d965.js"><link rel="prefetch" href="/assets/js/38.fae351d3.js"><link rel="prefetch" href="/assets/js/39.a40c9688.js"><link rel="prefetch" href="/assets/js/4.fe9ea34b.js"><link rel="prefetch" href="/assets/js/40.87c8b8ee.js"><link rel="prefetch" href="/assets/js/41.242cc580.js"><link rel="prefetch" href="/assets/js/42.736834a5.js"><link rel="prefetch" href="/assets/js/43.57a7a89e.js"><link rel="prefetch" href="/assets/js/44.2c085c54.js"><link rel="prefetch" href="/assets/js/45.fcfe6221.js"><link rel="prefetch" href="/assets/js/46.31dda88a.js"><link rel="prefetch" href="/assets/js/5.7bdab572.js"><link rel="prefetch" href="/assets/js/6.af184b79.js"><link rel="prefetch" href="/assets/js/7.d5eaab60.js"><link rel="prefetch" href="/assets/js/8.b99143ac.js"><link rel="prefetch" href="/assets/js/9.55a51475.js">
    <link rel="stylesheet" href="/assets/css/0.styles.ccac5a78.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">Rxjs</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/rxjs-docs/home.html" class="nav-link">
  rxjs
</a></div><div class="nav-item"><a href="/articles/home.html" class="nav-link">
  精选文章
</a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/rxjs-docs/home.html" class="nav-link">
  rxjs
</a></div><div class="nav-item"><a href="/articles/home.html" class="nav-link">
  精选文章
</a></div> <!----></nav>  <ul class="sidebar-links"><li><a href="/articles/home.html" class="sidebar-link">RxJS 优质文章翻译</a></li><li><a href="/articles/articles/ADVANCED-CACHING-WITH-RXJS.html" class="sidebar-link">[译] RxJS 高级缓存</a></li><li><a href="/articles/articles/Angular-Simple-Infinite-Scroller-Directive-With-RxJS-Observables.html" class="sidebar-link">[译] Angular: 使用 RxJS Observables 来实现简易版的无限滚动加载指令</a></li><li><a href="/articles/articles/Debugging-RxJS-Part1-Tooling.html" class="sidebar-link">[译] 调试 RxJS 第1部分: 工具篇</a></li><li><a href="/articles/articles/Debugging-RxJS-Part2-Logging.html" class="sidebar-link">[译] 调试 RxJS 第2部分: 日志篇</a></li><li><a href="/articles/articles/Don't-Unsubscribe.html" class="sidebar-link">[译] RxJS: 别取消订阅</a></li><li><a href="/articles/articles/Hot-Vs-Cold-Observables.html" class="sidebar-link">[译] 热的 Vs 冷的 Observables</a></li><li><a href="/articles/articles/How-To-Use-RefCount.html" class="sidebar-link">[译] RxJS: 如何使用 refCount</a></li><li><a href="/articles/articles/Infinite-Scroll-In-Angular-An-RxJS.html" class="sidebar-link">[译] 使用 Angular 和 RxJS 实现的无限滚动加载</a></li><li><a href="/articles/articles/Learn-To-Combine-RxJS-Sequences-With-Super-Intuitive-Interactive-Diagrams.html" class="sidebar-link">[译] RxJS: 使用超直观的交互图来学习组合操作符</a></li><li><a href="/articles/articles/Learning-Observable-By-Building-Observable.html" class="sidebar-link">[译] 通过构建 Observable 来学习 Observable</a></li><li><a href="/articles/articles/Naive-Infinite-Scroll-In-Reactive-Programming-Using-RxJS-Observables.html" class="sidebar-link">[译] 使用响应式编程来实现简易版的无限滚动加载</a></li><li><a href="/articles/articles/On-The-Subject-Of-Subjects.html" class="sidebar-link">[译] 关于 RxJS 中的 Subject</a></li><li><a href="/articles/articles/PRIMER-ON-RXJS-SCHEDULERS.html" class="sidebar-link">[译] RxJS 调度器入门</a></li><li><a href="/articles/articles/Reactive-Brain-Waves.html" class="sidebar-link">[译] 响应式脑电波</a></li><li><a href="/articles/articles/RxJS-Observable-Interop-With-Promises-And-Async-Await.html" class="sidebar-link">[译] RxJS Observable 与 Promises 和 Async-Await 交互</a></li><li><a href="/articles/articles/Six-Operators-That-You-Must-Know.html" class="sidebar-link">[译] RxJS: 6个你必须知道的操作符</a></li><li><a href="/articles/articles/Subjects-For-Human-Beings.html" aria-current="page" class="active sidebar-link">[译] RxJS: 白话 Subjects</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/articles/articles/Subjects-For-Human-Beings.html#subject-是-observable" class="sidebar-link">Subject 是 Observable</a></li><li class="sidebar-sub-header"><a href="/articles/articles/Subjects-For-Human-Beings.html#subject-是-observer" class="sidebar-link">Subject 是 Observer</a></li><li class="sidebar-sub-header"><a href="/articles/articles/Subjects-For-Human-Beings.html#behaviorsubject" class="sidebar-link">BehaviorSubject</a></li><li class="sidebar-sub-header"><a href="/articles/articles/Subjects-For-Human-Beings.html#replaysubject" class="sidebar-link">ReplaySubject</a></li><li class="sidebar-sub-header"><a href="/articles/articles/Subjects-For-Human-Beings.html#何时使用-subject" class="sidebar-link">何时使用 Subject</a></li></ul></li><li><a href="/articles/articles/TAMING-SNAKES-WITH-REACTIVE-STREAMS.html" class="sidebar-link">[译] RxJS 游戏之贪吃蛇</a></li><li><a href="/articles/articles/Testing-Race-Conditions-Using-RxJS-Marbles.html" class="sidebar-link">[译] RxJS 进阶技巧: 使用 RxJS Marbles 测试竞争条件</a></li><li><a href="/articles/articles/Understanding-Subjects-in-RxJS.html" class="sidebar-link">[译] 理解 RxJS 中 Subjects</a></li><li><a href="/articles/articles/Understanding-The-Publish-And-Share-Operators.html" class="sidebar-link">[译] RxJS: 理解 publish 和 share 操作符</a></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="译-rxjs-白话-subjects"><a href="#译-rxjs-白话-subjects" class="header-anchor">#</a> [译] RxJS: 白话 Subjects</h1> <blockquote><p>原文链接: <a href="https://netbasal.com/rxjs-subjects-for-human-beings-7807818d4e4d" target="_blank" rel="noopener noreferrer">https://netbasal.com/rxjs-subjects-for-human-beings-7807818d4e4d<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p></blockquote> <p><img src="/assets/img/header.ada78b84.png" alt="Subject"></p> <p>我已经发表过一篇关于 Subject 的<a href="https://netbasal.com/understanding-subjects-in-rxjs-55102a190f3" target="_blank" rel="noopener noreferrer">文章<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> (<a href="https://zhuanlan.zhihu.com/p/28061338" target="_blank" rel="noopener noreferrer">中文<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>)，但这次我想尝试一种不同的方式。</p> <p>要理解 <code>Subject</code> 是什么的最简单的方式就是重新创建一个。我们来创建一个简易版的 <code>Subject</code> 。</p> <p><em>注意: 下面的示例只是为了阐述概念，还不足以应用于实际开发之中，还有它们并不是 Rx 中 Subjects 的真正完整实现。</em></p> <p>我们来看看真相。</p> <p><strong><em>Subject 既是 Observable，又是 Observer 。</em></strong></p> <h2 id="subject-是-observable"><a href="#subject-是-observable" class="header-anchor">#</a> Subject 是 Observable</h2> <p>这表示它拥有所有的操作符 (<code>map</code>、<code>filter</code>，等等) 并且你可以订阅它。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">class</span> <span class="token class-name">MySubject</span> <span class="token keyword">extends</span> <span class="token class-name">Rx<span class="token punctuation">.</span>Observable</span> <span class="token punctuation">{</span>
 
 <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">super</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
 <span class="token punctuation">}</span>
 
<span class="token punctuation">}</span>
</code></pre></div><p>这是第一部分所需的一切了。它可以通过扩展 <code>Observable</code> 类成为 <code>Observable</code> 。</p> <h2 id="subject-是-observer"><a href="#subject-是-observer" class="header-anchor">#</a> Subject 是 Observer</h2> <p>这表示它必须实现 <code>next()</code>，<code>error()</code> 和 <code>complete()</code> 方法。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">class</span> <span class="token class-name">MySubject</span> <span class="token keyword">extends</span> <span class="token class-name">Rx<span class="token punctuation">.</span>Observable</span> <span class="token punctuation">{</span>
 
 <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
   <span class="token keyword">super</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
 <span class="token punctuation">}</span>

 <span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
  
 <span class="token function">error</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span> 
  
 <span class="token function">complete</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
 
<span class="token punctuation">}</span>
</code></pre></div><p>好了，我们来看下一个真相。</p> <p>Subject 可以扮演源 observable 和 众多观察者之间的桥梁或代理，使得多个观察者可以<strong>共享</strong>同一个 observable 执行。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">class</span> <span class="token class-name">MySubject</span> <span class="token keyword">extends</span> <span class="token class-name">Rx<span class="token punctuation">.</span>Observable</span> <span class="token punctuation">{</span>
 
 <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
   <span class="token keyword">super</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token keyword">this</span><span class="token punctuation">.</span>observers <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
 <span class="token punctuation">}</span>
 
 <span class="token function">subscribe</span><span class="token punctuation">(</span><span class="token parameter">observer</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
   <span class="token keyword">this</span><span class="token punctuation">.</span>observers<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>observer<span class="token punctuation">)</span><span class="token punctuation">;</span>
 <span class="token punctuation">}</span>
 
 <span class="token function">next</span><span class="token punctuation">(</span><span class="token parameter">value</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
   <span class="token keyword">this</span><span class="token punctuation">.</span>observers<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token parameter">observer</span> <span class="token operator">=&gt;</span> observer<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
 <span class="token punctuation">}</span>
 
 <span class="token function">error</span><span class="token punctuation">(</span><span class="token parameter">error</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
   <span class="token keyword">this</span><span class="token punctuation">.</span>observers<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token parameter">observer</span> <span class="token operator">=&gt;</span> observer<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span>error<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
 <span class="token punctuation">}</span>
 
 <span class="token function">complete</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
   <span class="token keyword">this</span><span class="token punctuation">.</span>observers<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token parameter">observer</span> <span class="token operator">=&gt;</span> observer<span class="token punctuation">.</span><span class="token function">complete</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
 <span class="token punctuation">}</span>
 
<span class="token punctuation">}</span>
</code></pre></div><p>当你调用 <code>subscribe()</code> 方法时，仅仅是将 <code>observer</code> 添加到一个数组中。<code>next()</code>、<code>error()</code> 和 <code>completed()</code> 方法会调用数组中每个 <code>observer</code> 的对应方法。</p> <p>来使用我们的 Subject 。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">const</span> interval$ <span class="token operator">=</span> Rx<span class="token punctuation">.</span>Observable<span class="token punctuation">.</span><span class="token function">interval</span><span class="token punctuation">(</span><span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">take</span><span class="token punctuation">(</span><span class="token number">7</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> subject <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">MySubject</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

subject<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token parameter">value</span> <span class="token operator">=&gt;</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">Observer one </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>value<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">subscribe</span><span class="token punctuation">(</span><span class="token parameter">value</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

interval$<span class="token punctuation">.</span><span class="token function">subscribe</span><span class="token punctuation">(</span>subject<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  subject<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token parameter">value</span> <span class="token operator">=&gt;</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">Observer two </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>value<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">subscribe</span><span class="token punctuation">(</span><span class="token parameter">value</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
     console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">2000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p><img src="/assets/img/Subject.175beb1a.gif" alt="Subject"></p> <p>当使用 <code>Subject</code> 时，无论你何时 <code>subscribe</code>， 你永远都会得到相同的执行，这点不同于典型的 observable，每次 <code>subscribe</code> 都会开启有个新的执行。(在我们的案例中，这表示你会有两个<strong>不相关的</strong> intervals)</p> <p><strong><em>Subject 让你同享相同的 observable 执行</em></strong></p> <p>我们来总结一下这里发生了什么。</p> <p>当对 subject 调用 <code>subscribe</code> 时，只是将 <code>observer</code> 添加到数组中。</p> <p>当 <code>subject</code> 扮演 <code>observer</code> 时，每当源 observable (在我们的案例中是指 <code>interval</code>) 发出值时，它会调用数组中每个 <code>observer</code> 的 <code>next()</code> 方法。</p> <h2 id="behaviorsubject"><a href="#behaviorsubject" class="header-anchor">#</a> BehaviorSubject</h2> <p>现在让我们来尝试实现 <code>BehaviorSubject</code> 的简易版。</p> <p>我们来看看<a href="https://stackoverflow.com/questions/39494058/behaviorsubject-vs-observable/40231605#40231605" target="_blank" rel="noopener noreferrer">真相<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>。</p> <ul><li><code>BehaviorSubject</code> 需要一个初始值，因为它必须始终返回一个订阅值，即使它还没接收到 <code>next()</code> 调用。</li> <li>被订阅后，它会返回 subject 的最新值。</li> <li>无论在任何时候，你都可以在非 observable 的代码中使用 <code>getValue()</code> 方法来获取 subject 的最新值。</li></ul> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">class</span> <span class="token class-name">MyBehaviorSubject</span> <span class="token keyword">extends</span> <span class="token class-name">Rx<span class="token punctuation">.</span>Observable</span> <span class="token punctuation">{</span>

  <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token parameter">initialValue</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">super</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>observers <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">typeof</span> initialValue <span class="token operator">===</span> <span class="token string">'undefined'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">Error</span><span class="token punctuation">(</span><span class="token string">'You need to provide initial value'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">this</span><span class="token punctuation">.</span>lastValue <span class="token operator">=</span> initialValue<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token function">subscribe</span><span class="token punctuation">(</span><span class="token parameter">observer</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>observers<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>observer<span class="token punctuation">)</span><span class="token punctuation">;</span>
    observer<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>lastValue<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token function">next</span><span class="token punctuation">(</span><span class="token parameter">value</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>lastValue <span class="token operator">=</span> value<span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>observers<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token parameter">observer</span> <span class="token operator">=&gt;</span> observer<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  
  <span class="token function">getValue</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>lastValue<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>


<span class="token punctuation">}</span>
</code></pre></div><p>来使用我们的 <code>BehaviorSubject</code> 。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">const</span> subject <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">MyBehaviorSubject</span><span class="token punctuation">(</span><span class="token string">'initialValue'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

subject<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token parameter">value</span> <span class="token operator">=&gt;</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">Observer one </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>value<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">subscribe</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">value</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

subject<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token string">'New value'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  subject<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token parameter">value</span> <span class="token operator">=&gt;</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">Observer two </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>value<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">subscribe</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">value</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">2000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p><img src="data:image/gif;base64,R0lGODlhDAGpAPUXAEyvUMfb+7Tdtk6wUmec9ZrSnKrH+V23YWa7aYKCgr/iwO729W6+cVuU9IbJiYWw93bCeZPPlej16N3w3lWzWZiYmNjY2P///7PO+bvhvZ/Uoa/csaXXp7vT+9Pi/Mfnybi4uD2B83Wl9ujo6EWG8zl+8sjIyOPt/d/x4J/B+KioqHC/c9bt1o7Nkc/q0H7FgQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACH5BAQZAAAAIf8LTkVUU0NBUEUyLjADAQAAACwAAAAADAGpAAAG/sCLcEgsGo+LRMI0AqmEypElUVlcKhWhKWG5WFSW5vKSrFi22SHV1L2oEiApyHRUJ8TP8mjLvZhAYW90dRcgcHtpQhVLYX4JKiNNIIWHb4mPRYZxFnMXI1QjloSjpKWmp6ipplNKY16tFSNkcFoJVnxKKlaUSlVEhkpWI4utsoRUjm3AVLa8SpOkxMhDrH1urWPDvdMSrkML0tZvzE+q5ufo6eeRRQvspu9E7rulkfTm8d/5pPbw+/ujIhkbAlCdwYMIEypcyLChw4cQI0qcSLGixYsYM2rcyLGjx1QAQoocSbKkyZMoU6pcybKly5cwY8qcCRMjzZs4c+rcybOn/s+Q8OaNmCeUaNGiQ38qXcq0qdOlC44OnXrv4NOrWLNqvWpzq9evYMOq7Cq2rNmzTsmiXcu2bUy1buPKnQsArkoEGjgUOBDSgYQXdLdCQNGiJYcJFFgeQFFA5QAJCyRkEBkhwsjKKCFElmA5p12UDOhJODAgwgUHgbU6uNCYpYILiUVmuMCgJIILGwakHJD3wgeRKGiHPHBBAsoDHD6w1vn5pIsLHAbM5gDANGq2A3Rv1U0BAmmWCCCQFHBBPMkB3lkO8C2Sw3IALS4IKKm973sA9fHnH3ux5foFut1mnGkTCMECXwAwUCAZGohEHhnUhdTCAgJYsYADLEigXQQS/hRGwWxkdAZAAQtsIIQE5pkEgQQGIhASCiwEBx1lLF6QQWwnrRhZC9kB4IIELAgxX0gbQCZBbEWeuAAKw0W2QIQA+CVEiSOt91tIELAHAHmoFVCjBAXUl2VrALzQIX4fMAnAh1OKOFJztl2Agm4DRFWdEBso50JIQQpQwAdXzuaCBgV2ZtoFLHDAGJd8ChfkBxqwCBgAGgjxAQcSXFfSAVZsMBuTj10wgQZWuGiaBMnZiNIAyM1GZpAoYHrBpC8cdgGCtQYngAYNrqmBiRuIFCkHGgRXmEha4gdZdizqpsAExLKY4mpkvnBBZxMs0CikkpYEJ0m37RlSs6YFC0Bw/i5ChiMAxI12AHFqmiYuluwRNwEAWbrwbpZXujfZfiQVgFtIz0FQJ2yUnnZuee8WiOB5dFIrUoEMlHbtSLM9DIByKep3m7n6UYCAtSDXOe/G5YU7ksimVfveANa2li2+F+h7AL/e9gceoiEdTIF1Ic0mnnI1a5CYtUVoaLGbAKjb8p1FqOlexye5d12lPEpg3J0OrGdEbSmNKRILAMJ8HwCzrSt0lQB8LNJgRFyJX7LwXaCBaZYNIOUQUMbcs98AzHwoEWq+qfNKAvZcHNchkVcbb2SLGqVvDrTQggPXAT2Sey0EyZdpAlxu+aRTr1TpdQJnHe9pFMhZeeU8qiRx/kgzm00m2gjLJhy4A48LnQOmyW3lSMS5oJyLFESlgQPugTy77XxqC7rllU9quEUuNYsez6ZFB0CQYIdEQXAH3MaCSZqLFG7N9gkv7O4pVdrrbKhpHZJ1oVIAMEqzf69tmWd7jcbIQ7W29Y44V1qN8CRXnyBJYE40C9YABAayLPUKgA0K1eQmk5JvVUlQDgiOZUyzgBa4R00sWF58yvYcAQDvUvdTGEkWdKyFbQB4LuhM6e5ChhaQMDFLiiFq3MMCzAngfJmJgL8uF7j/+W0AlntOBFrgooQpIALXgUALBPYBy/2nclaQ28L0UsVKHbA4wMNTz4izgAIUQGRonI22/kK1gRdEgAVMq8vhVkKBBanqTrtA0YuIcKwDPGcIrUmfSAS2AP2FhAEyEsJ13BO+lAjsROZ5oBAbR4STlcSPU/qehibXmNsUwVwHWND/QEQEClxSTnRbkRBawwAhGIxIQ2ARyEY0hNqwEjKPBGUNkbVHlkDAAVUUCXocgKMBjIyZJDkmBNYFEwi84JYyOcALHPCd3RzAAelhyzcL+BIEOGAFJgGYNamJL3Duz4NM6VFq5qmV/fEHe/TMpz65Usx9+vOfnuknQAdK0JbAs6AIJahuTIGUhlLloUhJqEQnqswBDIUoF6XKQijKUYketKMgnctHQ0pStoy0pCi9yUfM/pHSljJlparAiT1duiqPwhQV5czLG7PjF4PNNKUHqExsEBABBPxUKY/RGgdxclOctsSUVhgN1+RJ05GsZkZ3uh1WeOMeT86kqadwyXOoo5zoKFKmLzlqVpDWyKW5RK09U+vw0moSsJqiJckDkAEHhCgDIUhBQ7igiYQApQkJgEUXylBsWsCZNb0mRMKSwGAFmaMasaCKMJIRlCKwCwXYczVWaNDTBjDYGSlAqiL5wNZKQqLrUEACe9rbk6qUrMdw0EtgG+xsc2bXUbSklmqqE4AOlSf2fU8+f/pAdmbDggIUKoaiKlYBGOUjR/nGS7MKiXuKlqmTEAc3n1JWdEt1/icJaEA5CjiJAiPzs+WQZ1AitFqP6gTBkuCsbtTBFLFE+KYF/oY35cEdfC9Gkt6S4qnGbdoFLGYuFpEmKo4cjpzeBa8Yngxn9qKZze7rr5UILEIF81nCUBMc76TyViryjXsqwxp4UVhOFjRkC7IkAHsGJzHPCZ/ISKbMBfhXu7Rp14vvVWADEwLBLNAOuU6jm9nUhmiDSkyWkqYbvJFEXQJrzOByCWTrocRqIcHaY1bHzCNUUiSr0VdkWoY0IhypZgLDowxNgrXWERluQ1jgybTknhVMWR68NbIREKy01klPhgQMSQEidy8FXu512Tnr6Tx3p9DBzjyVOjOdZZi6/jptDX+uEx00S2Kt35joOQVwtOgAgwIJfCAq5ElmnFwgsF6xiANp/LHi+lUeVT860IImQvYQlqXzda9RlRzfrcynTMrM+ZE1M+5qllqfHcbPbkFTWBCnyqIIZ4Y9rZsls0kyWBNFZjdBeg5fENi+N92LTsZVDgPGjZJgH8El5PlACJdDQhPKiU8qJINunpOBF0borIETQg11iUMdwg8ltykhCXWjScYR0YhILEmacbmcIBW8BTC8KiTpRp9DzYsMYKRbcMgYKhYHmOCVg2GR7S3slhwgSELg4KmmBLZIXqCQh5zlJgNGBhyNfAiTfDhKXrmATJKZk3neX6lDYkrL/hiSCGFqFwBWrJLv1vCVwRGjLPmdS9qwCudCuCAxaT6EaiLTvqPGzzOpyQAHvICd9MGPfa8JV5N88+7aoSpJ/q4x+sxUmvPVyTifyk24Y3PmbL9AVSefzppEXgiUz3yzX3J5zGv+85zvPOhHz5LOS570qD9JRRyKUaNAVCipjz1JokIV2tseohl1vVTcsVHZ+970vv+96YdP/OIb//jIT77yl8/85jv/+dCPvvSn35EFPKAD1M++9kcRgBCQAAPbD7/4L2AAEpDAAONPP/UxQIIQpED98Ic+Bkrg/vjbX/knEEEJGuCB+/u/+PlXAgRwAv9XgJ13AgQggARogAxI7XMBQAIiUBUNOIG95QESSIEYmIEauIEc2IEe+IEgGIIiOIIkWIImeIIomIIquIIs2IIu+IIwGIMyOIM0WIM2eIM4mIM6uIM82IM++INAGIRCOIREWIRGeIRImIRKuIRM2IRO+IRQGIVSOIVUWIVWeIVYmIVauIVc2IVe+IVgGIZiOIZkWIZmeIZomIZquIZs2IZu+IZwGIdyOId0WId2eId4mId6uId82Id++IeAGIiCOIiEWIiGeIiImIiKuIiM2IiO+IiQGImSOImUWImWeImYmImauImc2Ime+ImgGIqiOIqkWIqmeIqo+IdBAAAh+QQFZAAAACwAAAAADAGpAIAAAAAAAAAC/oSPqcvtD6OctNqLs968+w+G4kiW5omm6sq27gvH8kzX9o3n+s73/g8MCofEovGITCqXzKbzCY1Kp9Sq9YrNarfcrvcLDovH5LL5jE6r1+y2+w2Py+f0uv2Oz+v3/L7/DxgoOEhYaHiImKi4yNjo+AgZKTlJWWl5iZmpucnZ6fkJGio6SlpqeoqaqrrK2ur6ChsrO0tba3uLm6u7y9vr+wscLDxMXGx8jJysvMzc7PwMHS09TV1tfY2drb3N3e39DR4uPk5ebn6Onq6+zt7u/g4fLz9PX29/j5+vv8/f7/8PMKDAgQQLGjyIMKHChQwbOnwIMaLEiRQrWryIMaPGG40cO3r8CDKkyJEkS5o8iTKlypUsW7p8CVNSAQAh+QQFlgAeACwAAAAADAGpAIQ5fvIhlvMznvQ5ofRPjfRZk/VJqfVSrfZcsvZtoPV4p/ZouPd0vfh7wfiDrveMtPeIx/mUzPme0fqhwfmo1vu33fu94PzM3vvI5fzX6/3f8P7l7v3p9P7///8AAAAAAAAF/qAnjmRpnmiqrmzrvnAsz3Rt33iu73zv/8CgcEgsGo/IpHLJbDqf0Kh0Sq1ar9isdsvter/gsHhMLpvP6LR6zW673/C4fE6v2+/4vH7P7/v/gIGCg4SFhoeIiYqLjI2Oj5CRkpOUlZaXmJmam5ydnp+goaKjpKWmp6ipqqusra6vsLGys7S1tre4ubq7vL2+v8DBwsPExcbHyEQBy8zNzs/Q0dLT1NXW19jZ2tvc1WLd4OHi4+Tl5tdGHBsc6u0b6+/x8vPx5/b3+Pn63PDs6vD0AgoMyGOfwYMIE4b7prChw4cKGUKcSLHiwjAWM2rcGE0ix48gIXqsZuBBhAcD/pYh2IAgpMMBDRoIWGaAgQGIGTRwoEBu5LQBGzwE3ZCygYcELqdR8HDAHAIREJYZbQARAgQPFno+6cD1BbYLHh4EqOAhQgCjSJNGk+DhZrkFIjjMZOCB6kSsWp1w7doC2zuaQs96ADs4ZQADYINGXcbWAwezyxhwkMDB8YEMHJhJZhBAwFLHnJdBeFyZQ1NolOOqM/C42QEOUSNU9iBB2tPKUY0ublw2AAW5zSxkhtaAQ8vOHDAEWBDUMWRmeJlp4BlgtNvGrZ9F2duhr7UBg5n9NRqW7IVlYCc0qFBh2VIMEDTUlSoiQ4QMDdgex9A2AP8KEAR13FUewMfBAtEg/nAfbRFEVWAzVy1gFGwZeLDYM3BVwI5gVL0HQYUNXHXcMh5kEI0BHrS3nIUBRKCBVfKFRmJW0Kl4VVMeVigjdNvtxcI14J23TFCC1RYAWCkFNRMzAniggQADgGeiYMoxc0CKAUgZwJUYRPmUihF4QF01S53mnwfVtWeBBwNUeBN4wz3zlAVhQqBbkxoMAGWJT0UwAAY20SaNfDPx51ZnAzxl5IzNRBemAeDlGWWJ2knB3QpAhjekBwKgtQxZN5E1GAQzwVXCcFM5o1On85FHwpQiXkOWmWEiUBkCGmgQwIbL8IohVgKoo9tTpwZQoFEYGIVgNBE2OeVlJKjIKHQ0/oZ5ALEkxMkjFNx1p8I1KG4AnbjKLjNBf9VdEJSJXzKwgLvLlttMmAxUOJNRFLz77nHWXrPUoXB9xhZPvsqXIF5srdlAhu7CGwBmwonJpjQoJsvirmVJiCW1jdJ4I1wWvOuwMz36iOk1RAbw1HlGiXXkxEwSWjE0dC3LDHj8VfklNDdew5aZTbLz23wVphSsts3MmeUIDczsDFuTOYb0M5jxlxJ4KtJFY2cPQlflmgc4LQ23l/7o72ALgOWAYBs0EKaQF0SAwITL8JcvAxVAVjPVIsgonwRzJ7tMv9ZcVYG7y1R4uAg3hYkBAmQt6gzIjIlAld3v5r1iW/JJGw15/lUae+AClW39cFlNYxwT42ferTnJW5lstjUCECYmfc1t4JbtHIT2JwmL7e3MhEseVuEIy151KDVtxuWeBwwcvYwAohZYvDM7Lz3f7yNEhWeL0FPTZPiijdB5M6xZLpgI8jXFvfqwx+5VNgYkYFjSCFxvAAL5O3Nt/904wAJGZJD/heN/1xtHogg4jf3djxkGGGACSYQRtVjwgubwCQY3yEFraLCDIAzhtr4gwhKa0FgVPKEKN2iEgbhwICuM4QVfSMMavqMgMsxhSD6owx6KJIU+DOJdkkHEIhrxiEjcQ3OSmIcMFOABTMzDBQgAAAdEEQ9TBMADlnjFOVygAFXkpWIX41ABAADgXGOUwwYSAAAFiDGNbNgAGBPwRjiqwYltrKMd0zBFB+hxj3ycDSAHSchCGvKQiEykIhfJyEY68pGQjKQkJ0nJSlrykpjMpCY3yclOevKToAylKEdJylKa8pSoTKUqV8nKVrrylbCMpSxnScta2vKWuMylLnfJy1768pfADKYwh0nMYhrzmMhMpjKXycxmOvOZ0IymNKdJzWpa85ghAAA7" alt="Subject"></p> <h2 id="replaysubject"><a href="#replaysubject" class="header-anchor">#</a> ReplaySubject</h2> <p>现在让我们来尝试实现 <code>ReplaySubject</code> 的简易版。</p> <p>我们来看看<a href="https://github.com/Reactive-Extensions/RxJS/blob/master/doc/api/subjects/replaysubject.md" target="_blank" rel="noopener noreferrer">真相<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>.</p> <ul><li><code>ReplaySubject</code> 表示一个对象既是 observable 序列，又是 observer 。</li> <li>每次通知都会广播给所有已经订阅和未来的 observers，observers 会遵循<strong>缓冲</strong>调整策略。</li></ul> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">class</span> <span class="token class-name">MyReplaySubject</span> <span class="token keyword">extends</span> <span class="token class-name">Rx<span class="token punctuation">.</span>Observable</span> <span class="token punctuation">{</span>

  <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token parameter">bufferSize</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">super</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>observers <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>bufferSize <span class="token operator">=</span> bufferSize<span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>lastValues <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token function">subscribe</span><span class="token punctuation">(</span><span class="token parameter">observer</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>lastValues<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token parameter">val</span> <span class="token operator">=&gt;</span> observer<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span>val<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>observers<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>observer<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token function">next</span><span class="token punctuation">(</span><span class="token parameter">value</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>lastValues<span class="token punctuation">.</span>length <span class="token operator">===</span> <span class="token keyword">this</span><span class="token punctuation">.</span>bufferSize<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>lastValues<span class="token punctuation">.</span><span class="token function">shift</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">this</span><span class="token punctuation">.</span>lastValues<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>observers<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token parameter">observer</span> <span class="token operator">=&gt;</span> observer<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>来使用我们的 <code>ReplaySubject</code> 。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">const</span> subject <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">MyReplaySubject</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

subject<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token string">'One'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
subject<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token string">'Two'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
subject<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token string">'Three'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
subject<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token string">'Four'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
 subject<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token parameter">value</span> <span class="token operator">=&gt;</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">Later Observer </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>value<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">subscribe</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">value</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
   console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span><span class="token punctuation">;</span>
 <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">2000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p><img src="data:image/gif;base64,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" alt="Subject"></p> <h2 id="何时使用-subject"><a href="#何时使用-subject" class="header-anchor">#</a> 何时使用 Subject</h2> <ul><li>需要共享相同的 observable 执行。</li> <li>当需要决定观察者迟来时该怎么做，是否使用 <code>ReplaySubject</code>、<code>BehaviorSubject</code>？</li> <li>需要完全控制 <code>next()</code>、<code>error()</code> 和 <code>completed()</code> 方法。</li></ul> <p>在 <a href="https://medium.com/@NetanelBasal/" target="_blank" rel="noopener noreferrer">Medium<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> 或 <a href="https://twitter.com/NetanelBasal" target="_blank" rel="noopener noreferrer">Twitter<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> 关注我，以阅读更多 Angular、Vue 和 JS 相关内容！</p></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/articles/articles/Six-Operators-That-You-Must-Know.html" class="prev">
        [译] RxJS: 6个你必须知道的操作符
      </a></span> <span class="next"><a href="/articles/articles/TAMING-SNAKES-WITH-REACTIVE-STREAMS.html">
        [译] RxJS 游戏之贪吃蛇
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.de24a261.js" defer></script><script src="/assets/js/2.f6e3d3ee.js" defer></script><script src="/assets/js/13.e45c7342.js" defer></script>
  </body>
</html>
