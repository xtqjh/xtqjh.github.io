<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>编写弹珠测试 | Rxjs</title>
    <meta name="generator" content="VuePress 1.5.4">
    
    <meta name="description" content="目录">
    <link rel="preload" href="/assets/css/0.styles.ccac5a78.css" as="style"><link rel="preload" href="/assets/js/app.de24a261.js" as="script"><link rel="preload" href="/assets/js/2.f6e3d3ee.js" as="script"><link rel="preload" href="/assets/js/46.31dda88a.js" as="script"><link rel="prefetch" href="/assets/js/10.157238cf.js"><link rel="prefetch" href="/assets/js/11.41a012c6.js"><link rel="prefetch" href="/assets/js/12.b8086885.js"><link rel="prefetch" href="/assets/js/13.e45c7342.js"><link rel="prefetch" href="/assets/js/14.e3e54685.js"><link rel="prefetch" href="/assets/js/15.9351c89b.js"><link rel="prefetch" href="/assets/js/16.7d3aff72.js"><link rel="prefetch" href="/assets/js/17.cd3a7c14.js"><link rel="prefetch" href="/assets/js/18.7b5bc8d2.js"><link rel="prefetch" href="/assets/js/19.77700336.js"><link rel="prefetch" href="/assets/js/20.ca0fdbb6.js"><link rel="prefetch" href="/assets/js/21.d6bc78c5.js"><link rel="prefetch" href="/assets/js/22.2428074e.js"><link rel="prefetch" href="/assets/js/23.93a777ed.js"><link rel="prefetch" href="/assets/js/24.73aa7224.js"><link rel="prefetch" href="/assets/js/25.e43f6412.js"><link rel="prefetch" href="/assets/js/26.60ae3da3.js"><link rel="prefetch" href="/assets/js/27.03e00c07.js"><link rel="prefetch" href="/assets/js/28.95c8c079.js"><link rel="prefetch" href="/assets/js/29.eb8ac4a8.js"><link rel="prefetch" href="/assets/js/3.d907f710.js"><link rel="prefetch" href="/assets/js/30.5c09e00d.js"><link rel="prefetch" href="/assets/js/31.962a908d.js"><link rel="prefetch" href="/assets/js/32.c0fe7bdd.js"><link rel="prefetch" href="/assets/js/33.74f04d2b.js"><link rel="prefetch" href="/assets/js/34.20bdc3d5.js"><link rel="prefetch" href="/assets/js/35.d30ab2c2.js"><link rel="prefetch" href="/assets/js/36.d13995e1.js"><link rel="prefetch" href="/assets/js/37.08e1d965.js"><link rel="prefetch" href="/assets/js/38.fae351d3.js"><link rel="prefetch" href="/assets/js/39.a40c9688.js"><link rel="prefetch" href="/assets/js/4.fe9ea34b.js"><link rel="prefetch" href="/assets/js/40.87c8b8ee.js"><link rel="prefetch" href="/assets/js/41.242cc580.js"><link rel="prefetch" href="/assets/js/42.736834a5.js"><link rel="prefetch" href="/assets/js/43.57a7a89e.js"><link rel="prefetch" href="/assets/js/44.2c085c54.js"><link rel="prefetch" href="/assets/js/45.fcfe6221.js"><link rel="prefetch" href="/assets/js/5.7bdab572.js"><link rel="prefetch" href="/assets/js/6.af184b79.js"><link rel="prefetch" href="/assets/js/7.d5eaab60.js"><link rel="prefetch" href="/assets/js/8.b99143ac.js"><link rel="prefetch" href="/assets/js/9.55a51475.js">
    <link rel="stylesheet" href="/assets/css/0.styles.ccac5a78.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container no-sidebar"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">Rxjs</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/rxjs-docs/home.html" class="nav-link">
  rxjs
</a></div><div class="nav-item"><a href="/articles/home.html" class="nav-link">
  精选文章
</a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/rxjs-docs/home.html" class="nav-link">
  rxjs
</a></div><div class="nav-item"><a href="/articles/home.html" class="nav-link">
  精选文章
</a></div> <!----></nav>  <!----> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="编写弹珠测试"><a href="#编写弹珠测试" class="header-anchor">#</a> 编写弹珠测试</h1> <p>“弹珠测试”是使用一种叫做 <code>TestScheduler</code> 的专用的虚拟调度器 (VirtualScheduler) 的测试。它们可以使我们以同步且可靠的方式来测试异步操作。“弹珠符号”是源自许多人的教程与文档，例如，@jhusain、@headinthebox、@mattpodwysocki 和 @staltz 。实际上，是由 @staltz 首先提出建议将其作为创建单元测试的 DSL (Domain Specific Language 领域专用语言)，并且它已经经过改造并被采纳。</p> <h4 id="链接"><a href="#链接" class="header-anchor">#</a> 链接</h4> <ul><li><a href="https://github.com/ReactiveX/rxjs/blob/master/CONTRIBUTING.md" target="_blank" rel="noopener noreferrer">贡献指南<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li> <li><a href="https://github.com/ReactiveX/rxjs/blob/master/CODE_OF_CONDUCT.md" target="_blank" rel="noopener noreferrer">行为准则<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul> <h2 id="基础方法"><a href="#基础方法" class="header-anchor">#</a> 基础方法</h2> <p>单元测试添加了一些辅助方法，以使创建测试更容易。</p> <ul><li><code>hot(marbles: string, values?: object, error?: any)</code> - 创建一个“热的” Observable (Subject)，它将在测试开始时表现得
好像已经在“运行中”了。一个有趣的不同点是 <code>hot</code> 弹珠允许使用<code>^</code>字符来标志“零帧”所在处。这正是 Observables 订阅的起始点，
同时也是测试的起始点。</li> <li><code>cold(marbles: string, values?: object, error?: any)</code> - 创建一个“冷的” Observable ，当测试开始时它便开始订阅。</li> <li><code>expectObservable(actual: Observable&lt;T&gt;).toBe(marbles: string, values?: object, error?: any)</code> - 当 TestScheduler flush时，   安排一个断言。在 jasmine 的 <code>it</code> 块结束处 TestScheduler 会自动进行 flush 。</li> <li><code>expectSubscriptions(actualSubscriptionLogs: SubscriptionLog[]).toBe(subscriptionMarbles: string)</code> -
类似 <code>expectObservable</code> ，当 TestScheduler flush时，安排一个断言。<code>cold()</code> 和 <code>hot()</code> 都返回带有<code>subscriptions</code> 属性
(类型为  <code>SubscriptionLog[]</code>)的 Observable 。将 <code>subscriptions</code> 作为参数传给 <code>expectSubscriptions</code> 以断言是否匹配在 <code>toBe()</code> 中
给定的 <code>expectObservable</code> 弹珠图。Subscription 的弹珠图与 Observable 的弹珠图略有不同。详情请参见下面。</li></ul> <h3 id="hot-和-cold-的默认行为是符合人类认知的"><a href="#hot-和-cold-的默认行为是符合人类认知的" class="header-anchor">#</a> <code>hot</code> 和 <code>cold</code> 的默认行为是符合人类认知的</h3> <p>在 <code>hot</code> 和 <code>cold</code> 方法中，弹珠图中指定的值的字符都会作为字符串发出，除非将 <code>values</code> 参数传给了方法。因此：</p> <p><code>hot('--a--b')</code> 会发出 <code>&quot;a&quot;</code> 和 <code>&quot;b&quot;</code> ，但</p> <p><code>hot('--a--b', { a: 1, b: 2 })</code> 会发出 <code>1</code> 和 <code>2</code> 。</p> <p>同样的，未指明的错误就只发出默认字符串 <code>&quot;error&quot;</code>，所以：</p> <p><code>hot('---#')</code> 会发出错误 <code>&quot;error&quot;</code> , 但</p> <p><code>hot('---#', null, new SpecialError('test'))</code> 会发出 <code>new SpecialError('test')</code> 。</p> <h2 id="弹珠语法"><a href="#弹珠语法" class="header-anchor">#</a> 弹珠语法</h2> <p>弹珠语法是用字符串表示随“时间”流逝而发生的事件。任何弹珠字符串的首字符永远都表示“零帧”。“帧”是有点类似于虚拟毫秒的概念。</p> <ul><li><code>&quot;-&quot;</code> 时间: 10“帧”的时间段。</li> <li><code>&quot;|&quot;</code> 完成: 表示 Observalbe 成功完成。这是 Observable 生产者所发出的 <code>complete()</code> 信号。</li> <li><code>&quot;#&quot;</code> 错误: 终止 Observable 的错误。 这是 Observable 生产者所发出的 <code>error()</code> 信号。</li> <li><code>&quot;a&quot;</code> 任意字符: 所有其他字符表示由 Observalbe 生产者所发出的 <code>next()</code> 信号的值。</li> <li><code>&quot;()&quot;</code> 同步分组: 当多个事件需要在同一帧中同步地发出，用圆括号来将这些事件聚集在一起。你可以以这种形式来聚合值、完成或错误。
起始 <code>(</code> 的位置决定了值发出的时间。</li> <li><code>&quot;^&quot;</code> 订阅时间点: (只适用于热的 Observabe) 显示测试 Observable 订阅热的 Observable 的点。它是此 Observable 的“零帧”，在 <code>^</code>
前的所有帧都将是无效的。</li></ul> <h3 id="示例"><a href="#示例" class="header-anchor">#</a> 示例</h3> <p><code>'-'</code> 或 <code>'------'</code>: 相当于 <code>Observable.never()</code>，或一个从不发出值或完成的 Observable</p> <p><code>|</code>: 相当于 <code>Observable.empty()</code></p> <p><code>#</code>: 相当于 <code>Observable.throw()</code></p> <p><code>'--a--'</code>: 此 Observable 等待20“帧”后发出值 <code>a</code> ，然后永远不发出 <code>complete</code></p> <p><code>'--a--b--|</code>: 在20帧处发出 <code>a</code>，在50帧处发出 <code>b</code>，然后在80帧处发出 <code>complete</code></p> <p><code>'--a--b--#</code>: 在20帧处发出 <code>a</code>，在50帧处发出 <code>b</code>，然后在80帧处发出 <code>error</code></p> <p><code>'-a-^-b--|</code>: 这是个热的 Observable ，在-20帧处发出 <code>a</code>，然后在20帧处发出 <code>b</code> ，在50帧出发出 <code>complete</code></p> <p><code>'--(abc)-|'</code>: 在20帧处发出 <code>a</code>、<code>b</code> 和 <code>c</code>，然后在80帧处发出 <code>complete</code></p> <p><code>'-----(a|)'</code>: 在50帧处发出 <code>a</code> 和 <code>complete</code></p> <h2 id="subscription-的弹珠语法"><a href="#subscription-的弹珠语法" class="header-anchor">#</a> Subscription 的弹珠语法</h2> <p>Subscription 的弹珠语法与常见的弹珠语法略有不同。它表示随“时间”流逝而发生的<strong>订阅</strong>和<strong>取消订阅</strong>的时间点。在此类图中不应该出现其他类型的事件。</p> <ul><li><code>&quot;-&quot;</code> 时间: 10“帧”的时间段。</li> <li><code>&quot;^&quot;</code> 订阅时间点: 显示订阅发生的时间点。</li> <li><code>&quot;!&quot;</code> 取消订阅时间点: 显示取消订阅发生的时间点。</li></ul> <p>在 Subscription 的弹珠语法中 <code>^</code> 和 <code>!</code> 时间点<strong>最多只有一个</strong>。 除此之外，<code>-</code> 字符是唯一允许出现的字符。</p> <h3 id="示例-2"><a href="#示例-2" class="header-anchor">#</a> 示例</h3> <p><code>'-'</code> 或 <code>'------'</code>: 没有订阅发生。</p> <p><code>'--^--'</code>: 在20帧处发生了订阅，并且订阅没有被取消。</p> <p><code>'--^--!-</code>: 在20帧处发生了订阅，在50帧处订阅被取消了</p> <h2 id="测试剖析"><a href="#测试剖析" class="header-anchor">#</a> 测试剖析</h2> <p>一个基础的测试看起来应该是下面这样的：</p> <div class="language-js extra-class"><pre class="language-js"><code>
<span class="token keyword">var</span> e1 <span class="token operator">=</span> <span class="token function">hot</span><span class="token punctuation">(</span><span class="token string">'----a--^--b-------c--|'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> e2 <span class="token operator">=</span> <span class="token function">hot</span><span class="token punctuation">(</span>  <span class="token string">'---d-^--e---------f-----|'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> expected <span class="token operator">=</span>      <span class="token string">'---(be)----c-f-----|'</span><span class="token punctuation">;</span>

<span class="token function">expectObservable</span><span class="token punctuation">(</span>e1<span class="token punctuation">.</span><span class="token function">merge</span><span class="token punctuation">(</span>e2<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toBe</span><span class="token punctuation">(</span>expected<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><ul><li><code>hot</code> observables 的 <code>^</code> 字符应该<strong>永远</strong>是对齐的。</li> <li><code>cold</code> observables 或预期 observables 的<strong>首字符</strong>和 <code>hot</code> observables 的 <code>^</code> 应该<strong>永远</strong>彼此对齐的。</li> <li>尽量使用默认的发送值。当必要的时候才指定值 。</li></ul> <p>使用指定值的测试用例：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">var</span> values <span class="token operator">=</span> <span class="token punctuation">{</span>
  a<span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
  b<span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">,</span>
  c<span class="token operator">:</span> <span class="token number">3</span><span class="token punctuation">,</span>
  d<span class="token operator">:</span> <span class="token number">4</span><span class="token punctuation">,</span>
  x<span class="token operator">:</span> <span class="token number">1</span> <span class="token operator">+</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token comment">// a + c</span>
  y<span class="token operator">:</span> <span class="token number">2</span> <span class="token operator">+</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token comment">// b + d</span>
<span class="token punctuation">}</span>
<span class="token keyword">var</span> e1 <span class="token operator">=</span>    <span class="token function">hot</span><span class="token punctuation">(</span><span class="token string">'---a---b---|'</span><span class="token punctuation">,</span> values<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> e2 <span class="token operator">=</span>    <span class="token function">hot</span><span class="token punctuation">(</span><span class="token string">'-----c---d---|'</span><span class="token punctuation">,</span> values<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> expected <span class="token operator">=</span>  <span class="token string">'-----x---y---|'</span><span class="token punctuation">;</span>

<span class="token function">expectObservable</span><span class="token punctuation">(</span>e1<span class="token punctuation">.</span><span class="token function">zip</span><span class="token punctuation">(</span>e2<span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">x<span class="token punctuation">,</span> y</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token keyword">return</span> x <span class="token operator">+</span> y<span class="token punctuation">;</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">toBe</span><span class="token punctuation">(</span>expected<span class="token punctuation">,</span> values<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><ul><li>使用同一个散列表来查找所有的值，这可以确保多次使用的同一个字符有着同样的值。</li> <li>将结果值所表示的含义表达的越明显越好，毕竟这些是<strong>测试</strong>，我们最想要的是代码的清晰程度，而不是执行效率，所以 <code>x: 1 + 3, // a + c</code>
比 <code>x: 4</code> 要好。前者传达了<strong>为什么</strong>是4，而后者并没有做到这点。</li></ul> <p>使用 subscription 断言的测试用例：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">var</span> x <span class="token operator">=</span> <span class="token function">cold</span><span class="token punctuation">(</span>        <span class="token string">'--a---b---c--|'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> xsubs <span class="token operator">=</span>    <span class="token string">'------^-------!'</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> y <span class="token operator">=</span> <span class="token function">cold</span><span class="token punctuation">(</span>                <span class="token string">'---d--e---f---|'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> ysubs <span class="token operator">=</span>    <span class="token string">'--------------^-------------!'</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> e1 <span class="token operator">=</span> <span class="token function">hot</span><span class="token punctuation">(</span>  <span class="token string">'------x-------y------|'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> x<span class="token operator">:</span> x<span class="token punctuation">,</span> y<span class="token operator">:</span> y <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> expected <span class="token operator">=</span> <span class="token string">'--------a---b----d--e---f---|'</span><span class="token punctuation">;</span>

<span class="token function">expectObservable</span><span class="token punctuation">(</span>e1<span class="token punctuation">.</span><span class="token function">switch</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toBe</span><span class="token punctuation">(</span>expected<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">expectSubscriptions</span><span class="token punctuation">(</span>x<span class="token punctuation">.</span>subscriptions<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toBe</span><span class="token punctuation">(</span>xsubs<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">expectSubscriptions</span><span class="token punctuation">(</span>y<span class="token punctuation">.</span>subscriptions<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toBe</span><span class="token punctuation">(</span>ysubs<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><ul><li>将 <code>xsubs</code> 图和 <code>ysubs</code> 图的开头与 <code>expected</code> 图对齐。</li> <li>注意冷的 observable <code>x</code> 取消订阅的同时 <code>e1</code> 发出了 <code>y</code> 。</li></ul> <p>在大多数测试中，是没有必要测试订阅时间点和取消订阅时间点的，它们要不就非常明显，要不就在 <code>expected</code> 图中有所暗示。在这些情况下是不需要编写 subscription 断言的。在有内部 subscriptions 或冷的 observables 有多个订阅者的测试用例中，这些 subscription 断言还是有用的。</p> <h2 id="基于测试生成-png-弹珠图"><a href="#基于测试生成-png-弹珠图" class="header-anchor">#</a> 基于测试生成 PNG 弹珠图</h2> <p>通常，Jasmine 中的测试用例都是这样写的：<code>it('should do something', function () { /* ... */ })</code> 。要想时测试用例可以用来生成 PNG 弹珠图，你必须使用 <code>asDiagram(label)</code> 函数，像这样：</p> <div class="language-js extra-class"><pre class="language-js"><code>it<span class="token punctuation">.</span><span class="token function">asDiagram</span><span class="token punctuation">(</span>operatorLabel<span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token string">'should do something'</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// ...</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>举例来说，对于 <code>zip</code> 操作符，我们可以这样写：</p> <div class="language-js extra-class"><pre class="language-js"><code>it<span class="token punctuation">.</span><span class="token function">asDiagram</span><span class="token punctuation">(</span><span class="token string">'zip'</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token string">'should zip by concatenating'</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">var</span> e1 <span class="token operator">=</span>    <span class="token function">hot</span><span class="token punctuation">(</span><span class="token string">'---a---b---|'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">var</span> e2 <span class="token operator">=</span>    <span class="token function">hot</span><span class="token punctuation">(</span><span class="token string">'-----c---d---|'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">var</span> expected <span class="token operator">=</span>  <span class="token string">'-----x---y---|'</span><span class="token punctuation">;</span>
  <span class="token keyword">var</span> values <span class="token operator">=</span> <span class="token punctuation">{</span> x<span class="token operator">:</span> <span class="token string">'ac'</span><span class="token punctuation">,</span> y<span class="token operator">:</span> <span class="token string">'bd'</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>

  <span class="token keyword">var</span> result <span class="token operator">=</span> e1<span class="token punctuation">.</span><span class="token function">zip</span><span class="token punctuation">(</span>e2<span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">x<span class="token punctuation">,</span> y</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token keyword">return</span> <span class="token function">String</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token function">String</span><span class="token punctuation">(</span>y<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token function">expectObservable</span><span class="token punctuation">(</span>result<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toBe</span><span class="token punctuation">(</span>expected<span class="token punctuation">,</span> values<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>然后当运行 <code>npm run tests2png</code> 时，这个测试用例会解析并且在 <code>img/</code> 文件夹下创建一个 PNG 文件 <code>zip.png</code> (文件名取决于 <code>${operatorLabel}.png</code>)。</p></div> <footer class="page-edit"><!----> <!----></footer> <!----> </main></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.de24a261.js" defer></script><script src="/assets/js/2.f6e3d3ee.js" defer></script><script src="/assets/js/46.31dda88a.js" defer></script>
  </body>
</html>
